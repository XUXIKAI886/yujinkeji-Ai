[2025-01-04 14:19:18.922] ERROR: uncaughtException: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
Error: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)
    at Function._load (node:internal/modules/cjs/loader:1075:27)
    at TracingChannel.traceSync (node:diagnostics_channel:315:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)
    at Module.require (node:internal/modules/cjs/loader:1340:12)
    at require (node:internal/modules/helpers:141:16)
    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)
    at Module._compile (node:internal/modules/cjs/loader:1546:14)
    at Object..js (node:internal/modules/cjs/loader:1689:10)
    at Module.load (node:internal/modules/cjs/loader:1318:32)
Details: {
  "metadata": {
    "error": {
      "code": "MODULE_NOT_FOUND",
      "requireStack": [
        "/home/devbox/project/server/controllers/user.controller.js",
        "/home/devbox/project/server/routes/auth.routes.js",
        "/home/devbox/project/server/app.js"
      ]
    },
    "stack": "Error: Cannot find module '../models/pointRecord.model'\nRequire stack:\n- /home/devbox/project/server/controllers/user.controller.js\n- /home/devbox/project/server/routes/auth.routes.js\n- /home/devbox/project/server/app.js\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)\n    at Function._load (node:internal/modules/cjs/loader:1075:27)\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\n    at Module.require (node:internal/modules/cjs/loader:1340:12)\n    at require (node:internal/modules/helpers:141:16)\n    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)",
    "exception": true,
    "date": "Sat Jan 04 2025 14:19:18 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 37644,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 85245952,
        "heapTotal": 34463744,
        "heapUsed": 21415776,
        "external": 20376369,
        "arrayBuffers": 18262288
      }
    },
    "os": {
      "loadavg": [
        1.6,
        1.73,
        1.95
      ],
      "uptime": 3743933.58
    },
    "trace": [
      {
        "column": 15,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._resolveFilename",
        "line": 1249,
        "method": "_resolveFilename",
        "native": false
      },
      {
        "column": 27,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._load",
        "line": 1075,
        "method": "_load",
        "native": false
      },
      {
        "column": 14,
        "file": "node:diagnostics_channel",
        "function": "TracingChannel.traceSync",
        "line": 315,
        "method": "traceSync",
        "native": false
      },
      {
        "column": 24,
        "file": "node:internal/modules/cjs/loader",
        "function": "wrapModuleLoad",
        "line": 218,
        "method": null,
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.require",
        "line": 1340,
        "method": "require",
        "native": false
      },
      {
        "column": 16,
        "file": "node:internal/modules/helpers",
        "function": "require",
        "line": 141,
        "method": null,
        "native": false
      },
      {
        "column": 21,
        "file": "/home/devbox/project/server/controllers/user.controller.js",
        "function": null,
        "line": 2,
        "method": null,
        "native": false
      },
      {
        "column": 14,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module._compile",
        "line": 1546,
        "method": "_compile",
        "native": false
      },
      {
        "column": 10,
        "file": "node:internal/modules/cjs/loader",
        "function": "Object..js",
        "line": 1689,
        "method": ".js",
        "native": false
      },
      {
        "column": 32,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.load",
        "line": 1318,
        "method": "load",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-04 14:19:56.350] ERROR: uncaughtException: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
Error: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)
    at Function._load (node:internal/modules/cjs/loader:1075:27)
    at TracingChannel.traceSync (node:diagnostics_channel:315:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)
    at Module.require (node:internal/modules/cjs/loader:1340:12)
    at require (node:internal/modules/helpers:141:16)
    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)
    at Module._compile (node:internal/modules/cjs/loader:1546:14)
    at Object..js (node:internal/modules/cjs/loader:1689:10)
    at Module.load (node:internal/modules/cjs/loader:1318:32)
Details: {
  "metadata": {
    "error": {
      "code": "MODULE_NOT_FOUND",
      "requireStack": [
        "/home/devbox/project/server/controllers/user.controller.js",
        "/home/devbox/project/server/routes/auth.routes.js",
        "/home/devbox/project/server/app.js"
      ]
    },
    "stack": "Error: Cannot find module '../models/pointRecord.model'\nRequire stack:\n- /home/devbox/project/server/controllers/user.controller.js\n- /home/devbox/project/server/routes/auth.routes.js\n- /home/devbox/project/server/app.js\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)\n    at Function._load (node:internal/modules/cjs/loader:1075:27)\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\n    at Module.require (node:internal/modules/cjs/loader:1340:12)\n    at require (node:internal/modules/helpers:141:16)\n    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)",
    "exception": true,
    "date": "Sat Jan 04 2025 14:19:56 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 37936,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 85684224,
        "heapTotal": 34201600,
        "heapUsed": 21526136,
        "external": 20376369,
        "arrayBuffers": 18262288
      }
    },
    "os": {
      "loadavg": [
        2.07,
        1.84,
        1.98
      ],
      "uptime": 3743971.01
    },
    "trace": [
      {
        "column": 15,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._resolveFilename",
        "line": 1249,
        "method": "_resolveFilename",
        "native": false
      },
      {
        "column": 27,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._load",
        "line": 1075,
        "method": "_load",
        "native": false
      },
      {
        "column": 14,
        "file": "node:diagnostics_channel",
        "function": "TracingChannel.traceSync",
        "line": 315,
        "method": "traceSync",
        "native": false
      },
      {
        "column": 24,
        "file": "node:internal/modules/cjs/loader",
        "function": "wrapModuleLoad",
        "line": 218,
        "method": null,
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.require",
        "line": 1340,
        "method": "require",
        "native": false
      },
      {
        "column": 16,
        "file": "node:internal/modules/helpers",
        "function": "require",
        "line": 141,
        "method": null,
        "native": false
      },
      {
        "column": 21,
        "file": "/home/devbox/project/server/controllers/user.controller.js",
        "function": null,
        "line": 2,
        "method": null,
        "native": false
      },
      {
        "column": 14,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module._compile",
        "line": 1546,
        "method": "_compile",
        "native": false
      },
      {
        "column": 10,
        "file": "node:internal/modules/cjs/loader",
        "function": "Object..js",
        "line": 1689,
        "method": ".js",
        "native": false
      },
      {
        "column": 32,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.load",
        "line": 1318,
        "method": "load",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-04 14:21:25.352] ERROR: uncaughtException: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
Error: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)
    at Function._load (node:internal/modules/cjs/loader:1075:27)
    at TracingChannel.traceSync (node:diagnostics_channel:315:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)
    at Module.require (node:internal/modules/cjs/loader:1340:12)
    at require (node:internal/modules/helpers:141:16)
    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)
    at Module._compile (node:internal/modules/cjs/loader:1546:14)
    at Object..js (node:internal/modules/cjs/loader:1689:10)
    at Module.load (node:internal/modules/cjs/loader:1318:32)
Details: {
  "metadata": {
    "error": {
      "code": "MODULE_NOT_FOUND",
      "requireStack": [
        "/home/devbox/project/server/controllers/user.controller.js",
        "/home/devbox/project/server/routes/auth.routes.js",
        "/home/devbox/project/server/app.js"
      ]
    },
    "stack": "Error: Cannot find module '../models/pointRecord.model'\nRequire stack:\n- /home/devbox/project/server/controllers/user.controller.js\n- /home/devbox/project/server/routes/auth.routes.js\n- /home/devbox/project/server/app.js\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)\n    at Function._load (node:internal/modules/cjs/loader:1075:27)\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\n    at Module.require (node:internal/modules/cjs/loader:1340:12)\n    at require (node:internal/modules/helpers:141:16)\n    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)",
    "exception": true,
    "date": "Sat Jan 04 2025 14:21:25 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 38252,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 84418560,
        "heapTotal": 34201600,
        "heapUsed": 20679912,
        "external": 20376369,
        "arrayBuffers": 18262288
      }
    },
    "os": {
      "loadavg": [
        1.23,
        1.61,
        1.88
      ],
      "uptime": 3744060.01
    },
    "trace": [
      {
        "column": 15,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._resolveFilename",
        "line": 1249,
        "method": "_resolveFilename",
        "native": false
      },
      {
        "column": 27,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._load",
        "line": 1075,
        "method": "_load",
        "native": false
      },
      {
        "column": 14,
        "file": "node:diagnostics_channel",
        "function": "TracingChannel.traceSync",
        "line": 315,
        "method": "traceSync",
        "native": false
      },
      {
        "column": 24,
        "file": "node:internal/modules/cjs/loader",
        "function": "wrapModuleLoad",
        "line": 218,
        "method": null,
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.require",
        "line": 1340,
        "method": "require",
        "native": false
      },
      {
        "column": 16,
        "file": "node:internal/modules/helpers",
        "function": "require",
        "line": 141,
        "method": null,
        "native": false
      },
      {
        "column": 21,
        "file": "/home/devbox/project/server/controllers/user.controller.js",
        "function": null,
        "line": 2,
        "method": null,
        "native": false
      },
      {
        "column": 14,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module._compile",
        "line": 1546,
        "method": "_compile",
        "native": false
      },
      {
        "column": 10,
        "file": "node:internal/modules/cjs/loader",
        "function": "Object..js",
        "line": 1689,
        "method": ".js",
        "native": false
      },
      {
        "column": 32,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.load",
        "line": 1318,
        "method": "load",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-04 14:23:01.975] ERROR: uncaughtException: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
Error: Cannot find module '../models/pointRecord.model'
Require stack:
- /home/devbox/project/server/controllers/user.controller.js
- /home/devbox/project/server/routes/auth.routes.js
- /home/devbox/project/server/app.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)
    at Function._load (node:internal/modules/cjs/loader:1075:27)
    at TracingChannel.traceSync (node:diagnostics_channel:315:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)
    at Module.require (node:internal/modules/cjs/loader:1340:12)
    at require (node:internal/modules/helpers:141:16)
    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)
    at Module._compile (node:internal/modules/cjs/loader:1546:14)
    at Object..js (node:internal/modules/cjs/loader:1689:10)
    at Module.load (node:internal/modules/cjs/loader:1318:32)
Details: {
  "metadata": {
    "error": {
      "code": "MODULE_NOT_FOUND",
      "requireStack": [
        "/home/devbox/project/server/controllers/user.controller.js",
        "/home/devbox/project/server/routes/auth.routes.js",
        "/home/devbox/project/server/app.js"
      ]
    },
    "stack": "Error: Cannot find module '../models/pointRecord.model'\nRequire stack:\n- /home/devbox/project/server/controllers/user.controller.js\n- /home/devbox/project/server/routes/auth.routes.js\n- /home/devbox/project/server/app.js\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)\n    at Function._load (node:internal/modules/cjs/loader:1075:27)\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\n    at Module.require (node:internal/modules/cjs/loader:1340:12)\n    at require (node:internal/modules/helpers:141:16)\n    at Object.<anonymous> (/home/devbox/project/server/controllers/user.controller.js:2:21)\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)",
    "exception": true,
    "date": "Sat Jan 04 2025 14:23:01 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 38553,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 86159360,
        "heapTotal": 34463744,
        "heapUsed": 21475528,
        "external": 20376369,
        "arrayBuffers": 18262288
      }
    },
    "os": {
      "loadavg": [
        1.79,
        1.71,
        1.89
      ],
      "uptime": 3744156.63
    },
    "trace": [
      {
        "column": 15,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._resolveFilename",
        "line": 1249,
        "method": "_resolveFilename",
        "native": false
      },
      {
        "column": 27,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._load",
        "line": 1075,
        "method": "_load",
        "native": false
      },
      {
        "column": 14,
        "file": "node:diagnostics_channel",
        "function": "TracingChannel.traceSync",
        "line": 315,
        "method": "traceSync",
        "native": false
      },
      {
        "column": 24,
        "file": "node:internal/modules/cjs/loader",
        "function": "wrapModuleLoad",
        "line": 218,
        "method": null,
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.require",
        "line": 1340,
        "method": "require",
        "native": false
      },
      {
        "column": 16,
        "file": "node:internal/modules/helpers",
        "function": "require",
        "line": 141,
        "method": null,
        "native": false
      },
      {
        "column": 21,
        "file": "/home/devbox/project/server/controllers/user.controller.js",
        "function": null,
        "line": 2,
        "method": null,
        "native": false
      },
      {
        "column": 14,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module._compile",
        "line": 1546,
        "method": "_compile",
        "native": false
      },
      {
        "column": 10,
        "file": "node:internal/modules/cjs/loader",
        "function": "Object..js",
        "line": 1689,
        "method": ".js",
        "native": false
      },
      {
        "column": 32,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.load",
        "line": 1318,
        "method": "load",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-04 14:42:52.783] ERROR: Expected property name or '}' in JSON at position 1 (line 1 column 2)
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "SyntaxError: Expected property name or '}' in JSON at position 1 (line 1 column 2)\n    at JSON.parse (<anonymous>)\n    at parse (/home/devbox/project/node_modules/body-parser/lib/types/json.js:92:19)\n    at /home/devbox/project/node_modules/body-parser/lib/read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)\n    at invokeCallback (/home/devbox/project/node_modules/raw-body/index.js:238:16)\n    at done (/home/devbox/project/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/home/devbox/project/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:518:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)",
    "path": "/api/auth/login",
    "method": "POST",
    "body": {},
    "user": "anonymous"
  }
}
[2025-01-04 15:36:34.034] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:36:34.034] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:36:36.125] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:36:36.125] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:36:40.213] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:36:40.213] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:36:40.214] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 15:36:40.214] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 15:37:13.904] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:37:13.905] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:37:15.991] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:37:15.992] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:37:20.085] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:37:20.085] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:37:20.086] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 15:37:20.086] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 15:37:53.881] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:37:53.881] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:37:55.970] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:37:55.970] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:38:00.068] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:38:00.068] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:38:00.069] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 15:38:00.069] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 15:47:18.854] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:47:18.855] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:47:20.946] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:47:20.947] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:47:25.045] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 15:47:25.045] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 15:47:25.046] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 15:47:25.047] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:03:39.076] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:03:39.076] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:03:41.166] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:03:41.167] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:03:45.268] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:03:45.268] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:03:45.269] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:03:45.269] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:15:53.449] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:15:53.450] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:15:55.532] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:15:55.533] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:15:59.621] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:15:59.621] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:15:59.622] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:15:59.622] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:16:48.787] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:16:48.788] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:16:50.882] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:16:50.882] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:16:54.981] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:16:54.981] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:16:54.981] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:16:54.982] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:17:28.506] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:17:28.507] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:17:30.622] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:17:30.623] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:17:34.707] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:17:34.708] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7432139594210115595",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:17:34.708] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:17:34.709] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:20:18.428] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:20:18.428] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:20:20.596] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:20:20.597] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:20:24.766] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:20:24.767] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:20:24.767] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:20:24.767] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:29:41.763] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:29:41.764] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:29:43.855] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:29:43.855] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:29:47.941] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:29:47.942] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:29:47.942] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:29:47.942] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:31:54.116] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:31:54.116] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:31:56.205] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:31:56.205] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:32:00.298] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:32:00.299] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:32:00.299] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:32:00.300] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:36:03.496] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:36:03.497] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:36:05.591] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:36:05.592] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:36:09.754] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:36:09.754] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:36:09.755] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:36:09.755] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:42:11.563] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:42:11.564] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:42:13.749] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:42:13.750] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:42:17.837] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:42:17.837] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:42:17.838] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:42:17.838] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:44:47.229] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:44:47.229] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:44:49.321] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:44:49.321] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:44:53.417] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:44:53.418] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:44:53.418] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:44:53.419] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:45:03.531] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:45:03.531] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:45:05.620] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:45:05.621] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:45:09.715] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:45:09.715] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:45:09.716] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:45:09.716] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:48:10.846] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:48:10.846] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:48:12.937] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:48:12.938] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:48:17.024] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:48:17.025] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:48:17.025] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:48:17.025] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-04 16:50:37.822] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:50:37.822] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:50:39.912] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:50:39.912] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:50:44.003] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-04 16:50:44.003] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-04 16:50:44.004] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-04 16:50:44.004] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 00:49:47.775] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 00:49:47.775] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 00:49:50.001] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 00:49:50.002] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 00:49:54.096] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 00:49:54.096] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 00:49:54.097] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 00:49:54.098] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 00:59:03.993] ERROR: 创建AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "crypto.randomBytes is not a function",
    "name": "美团分类栏描述",
    "type": "general"
  }
}
[2025-01-05 00:59:03.994] ERROR: 创建AI助手失败: crypto.randomBytes is not a function
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "ApiError: 创建AI助手失败: crypto.randomBytes is not a function\n    at AiAssistantService.createAssistant (/home/devbox/project/server/services/aiAssistant.service.js:54:19)\n    at exports.createAssistant (/home/devbox/project/server/controllers/aiAssistant.controller.js:37:52)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.adminAuth (/home/devbox/project/server/middleware/adminAuth.js:13:9)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.auth (/home/devbox/project/server/middleware/auth.js:27:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "path": "/api/assistants",
    "method": "POST",
    "body": {
      "name": "美团分类栏描述",
      "description": "美食分类助手，优化描述配表情,提升用户体验",
      "type": "general",
      "pointsCost": 10,
      "isActive": true,
      "config": {
        "modelType": "coze",
        "apiKey": "pat_gMDZEOZoPKPPcr57dT2lNUGCFjqlkYo67GCcDtFTdYkrW92iXVlcLzVAeXgei92l",
        "temperature": 0.7,
        "maxTokens": 2000,
        "model": "coze-bot",
        "botId": "7444769224897085503",
        "apiUrl": "https://api.coze.cn/open_api/v2/chat"
      }
    },
    "user": "677426b8bf3ce254abeac7f4"
  }
}
[2025-01-05 01:02:36.034] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:02:36.034] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:02:38.128] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:02:38.129] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:02:42.213] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:02:42.214] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:02:42.214] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:02:42.214] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:05:40.097] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:05:40.098] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:05:42.192] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:05:42.193] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:05:46.364] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:05:46.364] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:05:46.365] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:05:46.365] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:10:37.417] ERROR: 创建AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "crypto.randomBytes is not a function",
    "name": "测试助手",
    "type": "general"
  }
}
[2025-01-05 01:10:37.418] ERROR: 创建AI助手失败: crypto.randomBytes is not a function
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "ApiError: 创建AI助手失败: crypto.randomBytes is not a function\n    at AiAssistantService.createAssistant (/home/devbox/project/server/services/aiAssistant.service.js:54:19)\n    at exports.createAssistant (/home/devbox/project/server/controllers/aiAssistant.controller.js:37:52)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.adminAuth (/home/devbox/project/server/middleware/adminAuth.js:13:9)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.auth (/home/devbox/project/server/middleware/auth.js:27:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "path": "/api/assistants",
    "method": "POST",
    "body": {
      "name": "测试助手",
      "description": "这是一个测试用的AI助手",
      "type": "general",
      "pointsCost": 1,
      "isActive": true,
      "config": {
        "modelType": "coze",
        "model": "coze-bot",
        "apiKey": "test-api-key",
        "apiUrl": "https://api.coze.cn/open_api/v2/chat",
        "temperature": 0.7,
        "maxTokens": 2000,
        "botId": "test-bot-id"
      }
    },
    "user": "677426b8bf3ce254abeac7f4"
  }
}
[2025-01-05 01:10:58.157] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:10:58.157] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:00.245] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:11:00.245] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:04.325] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:11:04.325] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:04.326] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:11:04.326] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:11:27.026] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:11:27.026] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:29.111] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:11:29.112] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:33.204] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:11:33.204] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:11:33.205] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:11:33.205] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:13:08.013] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:08.013] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:10.094] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:10.095] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:14.188] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:14.188] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:14.189] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:13:14.189] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:13:32.884] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:32.884] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:34.988] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:34.989] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:39.082] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:13:39.082] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:13:39.083] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:13:39.083] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:26:11.222] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:26:11.223] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:26:13.311] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:26:13.312] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:26:17.468] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:26:17.468] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:26:17.469] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:26:17.469] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:27:27.216] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:27:27.217] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:27:29.303] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:27:29.304] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:27:33.388] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:27:33.388] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:27:33.389] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:27:33.389] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:28:04.453] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:28:04.453] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:28:06.542] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:28:06.542] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:28:10.635] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:28:10.635] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:28:10.636] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:28:10.636] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:29:50.216] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:29:50.216] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:29:52.310] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:29:52.311] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:29:56.391] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:29:56.391] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:29:56.392] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:29:56.392] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:30:31.764] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:30:31.764] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:30:33.859] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:30:33.860] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:30:37.974] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:30:37.975] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:30:37.975] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:30:37.976] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:31:37.004] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:31:37.004] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:31:39.167] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:31:39.168] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:31:43.265] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:31:43.265] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:31:43.266] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:31:43.266] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:32:05.137] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:32:05.137] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:32:07.228] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:32:07.229] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:32:11.321] ERROR: Coze API调用失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "code": 4000,
    "msg": "The field http body provided is not a valid json or chat request. Please check your input."
  }
}
[2025-01-05 01:32:11.321] ERROR: Coze API调用出错:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:125:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)",
    "config": {
      "modelType": "coze",
      "model": "coze-bot",
      "apiKey": "***",
      "apiUrl": "https://api.coze.cn/open_api/v2/chat",
      "temperature": 0.8,
      "maxTokens": 2000,
      "botId": "7450790638439907355",
      "hasApiKey": true,
      "hasBotId": true,
      "hasApiUrl": true
    }
  }
}
[2025-01-05 01:32:11.322] ERROR: 所有重试尝试都失败
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "totalAttempts": 3,
    "finalError": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "stack": "Error: 请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.\n    at makeRequest (/home/devbox/project/server/services/cozeService.js:149:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exports.retry (/home/devbox/project/server/utils/helpers.js:144:28)\n    at async CozeService.chat (/home/devbox/project/server/services/cozeService.js:157:28)\n    at async exports.chat (/home/devbox/project/server/controllers/aiAssistant.controller.js:135:24)"
  }
}
[2025-01-05 01:32:11.322] ERROR: Coze API调用最终失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "请求错误：API调用失败：The field http body provided is not a valid json or chat request. Please check your input.",
    "attempts": 3
  }
}
[2025-01-05 01:38:16.077] ERROR: 创建AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "crypto.randomBytes is not a function",
    "name": "测试助手",
    "type": "general"
  }
}
[2025-01-05 01:38:16.078] ERROR: 创建AI助手失败: crypto.randomBytes is not a function
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "ApiError: 创建AI助手失败: crypto.randomBytes is not a function\n    at AiAssistantService.createAssistant (/home/devbox/project/server/services/aiAssistant.service.js:54:19)\n    at exports.createAssistant (/home/devbox/project/server/controllers/aiAssistant.controller.js:37:52)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.adminAuth (/home/devbox/project/server/middleware/adminAuth.js:13:9)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.auth (/home/devbox/project/server/middleware/auth.js:27:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "path": "/api/assistants",
    "method": "POST",
    "body": {
      "name": "测试助手",
      "description": "这是一个测试用的AI助手",
      "type": "general",
      "pointsCost": 1,
      "config": {
        "modelType": "coze",
        "apiKey": "sk-0123456789abcdef",
        "botId": "bot_0123456789",
        "apiUrl": "https://api.coze.cn/open_api/v2/chat",
        "temperature": 0.7,
        "maxTokens": 2000
      },
      "isActive": true
    },
    "user": "677426b8bf3ce254abeac7f4"
  }
}
[2025-01-05 01:38:41.469] ERROR: 创建AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "crypto.randomBytes is not a function",
    "name": "测试助手",
    "type": "general"
  }
}
[2025-01-05 01:38:41.470] ERROR: 创建AI助手失败: crypto.randomBytes is not a function
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "ApiError: 创建AI助手失败: crypto.randomBytes is not a function\n    at AiAssistantService.createAssistant (/home/devbox/project/server/services/aiAssistant.service.js:54:19)\n    at exports.createAssistant (/home/devbox/project/server/controllers/aiAssistant.controller.js:37:52)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.adminAuth (/home/devbox/project/server/middleware/adminAuth.js:13:9)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.auth (/home/devbox/project/server/middleware/auth.js:27:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "path": "/api/assistants",
    "method": "POST",
    "body": {
      "name": "测试助手",
      "description": "这是一个测试用的AI助手",
      "type": "general",
      "pointsCost": 1,
      "config": {
        "modelType": "coze",
        "apiKey": "sk-0123456789abcdef",
        "botId": "bot_0123456789",
        "apiUrl": "https://api.coze.cn/open_api/v2/chat",
        "temperature": 0.7,
        "maxTokens": 2000
      },
      "isActive": true
    },
    "user": "677426b8bf3ce254abeac7f4"
  }
}
[2025-01-05 01:39:06.194] ERROR: 创建AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "crypto.randomBytes is not a function",
    "name": "测试助手",
    "type": "general"
  }
}
[2025-01-05 01:39:06.194] ERROR: 创建AI助手失败: crypto.randomBytes is not a function
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "stack": "ApiError: 创建AI助手失败: crypto.randomBytes is not a function\n    at AiAssistantService.createAssistant (/home/devbox/project/server/services/aiAssistant.service.js:54:19)\n    at exports.createAssistant (/home/devbox/project/server/controllers/aiAssistant.controller.js:37:52)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.adminAuth (/home/devbox/project/server/middleware/adminAuth.js:13:9)\n    at Layer.handle [as handle_request] (/home/devbox/project/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/devbox/project/node_modules/express/lib/router/route.js:149:13)\n    at exports.auth (/home/devbox/project/server/middleware/auth.js:27:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "path": "/api/assistants",
    "method": "POST",
    "body": {
      "name": "测试助手",
      "description": "这是一个测试用的AI助手",
      "type": "general",
      "pointsCost": 1,
      "config": {
        "modelType": "coze",
        "apiKey": "sk-0123456789abcdef",
        "botId": "bot_0123456789",
        "apiUrl": "https://api.coze.cn/open_api/v2/chat",
        "temperature": 0.7,
        "maxTokens": 2000
      },
      "isActive": true
    },
    "user": "677426b8bf3ce254abeac7f4"
  }
}
[2025-01-05 01:39:30.220] ERROR: uncaughtException: Route.get() requires a callback function but got a [object Undefined]
Error: Route.get() requires a callback function but got a [object Undefined]
    at Route.<computed> [as get] (/home/devbox/project/node_modules/express/lib/router/route.js:216:15)
    at proto.<computed> [as get] (/home/devbox/project/node_modules/express/lib/router/index.js:521:19)
    at Object.<anonymous> (/home/devbox/project/server/routes/aiAssistant.routes.js:12:8)
    at Module._compile (node:internal/modules/cjs/loader:1546:14)
    at Object..js (node:internal/modules/cjs/loader:1689:10)
    at Module.load (node:internal/modules/cjs/loader:1318:32)
    at Function._load (node:internal/modules/cjs/loader:1128:12)
    at TracingChannel.traceSync (node:diagnostics_channel:315:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)
    at Module.require (node:internal/modules/cjs/loader:1340:12)
Details: {
  "metadata": {
    "error": {},
    "stack": "Error: Route.get() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as get] (/home/devbox/project/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as get] (/home/devbox/project/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/home/devbox/project/server/routes/aiAssistant.routes.js:12:8)\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)\n    at Function._load (node:internal/modules/cjs/loader:1128:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\n    at Module.require (node:internal/modules/cjs/loader:1340:12)",
    "exception": true,
    "date": "Sun Jan 05 2025 01:39:30 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 11761,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 91971584,
        "heapTotal": 36560896,
        "heapUsed": 26419792,
        "external": 21412971,
        "arrayBuffers": 18311345
      }
    },
    "os": {
      "loadavg": [
        3.42,
        3.33,
        2.95
      ],
      "uptime": 3784744.88
    },
    "trace": [
      {
        "column": 15,
        "file": "/home/devbox/project/node_modules/express/lib/router/route.js",
        "function": "Route.<computed> [as get]",
        "line": 216,
        "method": "<computed> [as get]",
        "native": false
      },
      {
        "column": 19,
        "file": "/home/devbox/project/node_modules/express/lib/router/index.js",
        "function": "proto.<computed> [as get]",
        "line": 521,
        "method": "<computed> [as get]",
        "native": false
      },
      {
        "column": 8,
        "file": "/home/devbox/project/server/routes/aiAssistant.routes.js",
        "function": null,
        "line": 12,
        "method": null,
        "native": false
      },
      {
        "column": 14,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module._compile",
        "line": 1546,
        "method": "_compile",
        "native": false
      },
      {
        "column": 10,
        "file": "node:internal/modules/cjs/loader",
        "function": "Object..js",
        "line": 1689,
        "method": ".js",
        "native": false
      },
      {
        "column": 32,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.load",
        "line": 1318,
        "method": "load",
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Function._load",
        "line": 1128,
        "method": "_load",
        "native": false
      },
      {
        "column": 14,
        "file": "node:diagnostics_channel",
        "function": "TracingChannel.traceSync",
        "line": 315,
        "method": "traceSync",
        "native": false
      },
      {
        "column": 24,
        "file": "node:internal/modules/cjs/loader",
        "function": "wrapModuleLoad",
        "line": 218,
        "method": null,
        "native": false
      },
      {
        "column": 12,
        "file": "node:internal/modules/cjs/loader",
        "function": "Module.require",
        "line": 1340,
        "method": "require",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-05 01:46:26.486] ERROR: uncaughtException: listen EADDRINUSE: address already in use :::3000
Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1907:16)
    at listenInCluster (node:net:1964:12)
    at Server.listen (node:net:2066:7)
    at Function.listen (/home/devbox/project/node_modules/express/lib/application.js:635:24)
    at /home/devbox/project/server/app.js:82:9
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Details: {
  "metadata": {
    "error": {
      "code": "EADDRINUSE",
      "errno": -98,
      "syscall": "listen",
      "address": "::",
      "port": 3000
    },
    "stack": "Error: listen EADDRINUSE: address already in use :::3000\n    at Server.setupListenHandle [as _listen2] (node:net:1907:16)\n    at listenInCluster (node:net:1964:12)\n    at Server.listen (node:net:2066:7)\n    at Function.listen (/home/devbox/project/node_modules/express/lib/application.js:635:24)\n    at /home/devbox/project/server/app.js:82:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "exception": true,
    "date": "Sun Jan 05 2025 01:46:26 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 13879,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 96911360,
        "heapTotal": 40386560,
        "heapUsed": 26516808,
        "external": 21668685,
        "arrayBuffers": 18325613
      }
    },
    "os": {
      "loadavg": [
        3.5,
        3.48,
        3.14
      ],
      "uptime": 3785161.14
    },
    "trace": [
      {
        "column": 16,
        "file": "node:net",
        "function": "Server.setupListenHandle [as _listen2]",
        "line": 1907,
        "method": "setupListenHandle [as _listen2]",
        "native": false
      },
      {
        "column": 12,
        "file": "node:net",
        "function": "listenInCluster",
        "line": 1964,
        "method": null,
        "native": false
      },
      {
        "column": 7,
        "file": "node:net",
        "function": "Server.listen",
        "line": 2066,
        "method": "listen",
        "native": false
      },
      {
        "column": 24,
        "file": "/home/devbox/project/node_modules/express/lib/application.js",
        "function": "Function.listen",
        "line": 635,
        "method": "listen",
        "native": false
      },
      {
        "column": 9,
        "file": "/home/devbox/project/server/app.js",
        "function": null,
        "line": 82,
        "method": null,
        "native": false
      },
      {
        "column": 5,
        "file": "node:internal/process/task_queues",
        "function": "process.processTicksAndRejections",
        "line": 105,
        "method": "processTicksAndRejections",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-05 01:47:28.025] ERROR: uncaughtException: listen EADDRINUSE: address already in use :::3000
Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1907:16)
    at listenInCluster (node:net:1964:12)
    at Server.listen (node:net:2066:7)
    at Function.listen (/home/devbox/project/node_modules/express/lib/application.js:635:24)
    at /home/devbox/project/server/app.js:82:9
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Details: {
  "metadata": {
    "error": {
      "code": "EADDRINUSE",
      "errno": -98,
      "syscall": "listen",
      "address": "::",
      "port": 3000
    },
    "stack": "Error: listen EADDRINUSE: address already in use :::3000\n    at Server.setupListenHandle [as _listen2] (node:net:1907:16)\n    at listenInCluster (node:net:1964:12)\n    at Server.listen (node:net:2066:7)\n    at Function.listen (/home/devbox/project/node_modules/express/lib/application.js:635:24)\n    at /home/devbox/project/server/app.js:82:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)",
    "exception": true,
    "date": "Sun Jan 05 2025 01:47:28 GMT+0000 (Coordinated Universal Time)",
    "process": {
      "pid": 14014,
      "uid": 1000,
      "gid": 1000,
      "cwd": "/home/devbox/project",
      "execPath": "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
      "version": "v22.11.0",
      "argv": [
        "/home/devbox/.nvm/versions/node/v22.11.0/bin/node",
        "/home/devbox/project/server/app.js"
      ],
      "memoryUsage": {
        "rss": 97177600,
        "heapTotal": 40124416,
        "heapUsed": 26494344,
        "external": 21668685,
        "arrayBuffers": 18325613
      }
    },
    "os": {
      "loadavg": [
        3.26,
        3.42,
        3.14
      ],
      "uptime": 3785222.68
    },
    "trace": [
      {
        "column": 16,
        "file": "node:net",
        "function": "Server.setupListenHandle [as _listen2]",
        "line": 1907,
        "method": "setupListenHandle [as _listen2]",
        "native": false
      },
      {
        "column": 12,
        "file": "node:net",
        "function": "listenInCluster",
        "line": 1964,
        "method": null,
        "native": false
      },
      {
        "column": 7,
        "file": "node:net",
        "function": "Server.listen",
        "line": 2066,
        "method": "listen",
        "native": false
      },
      {
        "column": 24,
        "file": "/home/devbox/project/node_modules/express/lib/application.js",
        "function": "Function.listen",
        "line": 635,
        "method": "listen",
        "native": false
      },
      {
        "column": 9,
        "file": "/home/devbox/project/server/app.js",
        "function": null,
        "line": 82,
        "method": null,
        "native": false
      },
      {
        "column": 5,
        "file": "node:internal/process/task_queues",
        "function": "process.processTicksAndRejections",
        "line": 105,
        "method": "processTicksAndRejections",
        "native": false
      }
    ],
    "service": "ai-assistant-api"
  }
}
[2025-01-05 01:52:26.019] ERROR: 更新AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "Validation failed: type: 无效的AI助手类型",
    "id": "6779e394bc9ae6bfb80d430e",
    "name": "更新后的助手"
  }
}
[2025-01-05 01:52:38.950] ERROR: 更新AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "Validation failed: type: 无效的AI助手类型",
    "id": "6779e394bc9ae6bfb80d430e",
    "name": "更新后的助手"
  }
}
[2025-01-05 01:52:49.596] ERROR: 更新AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "Validation failed: type: 无效的AI助手类型",
    "id": "6779e394bc9ae6bfb80d430e",
    "name": "更新后的助手"
  }
}
[2025-01-05 01:55:08.455] ERROR: 更新AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "找不到指定的AI助手",
    "id": "6779e5acbc9ae6bfb80d4310",
    "name": "更新后的助手"
  }
}
[2025-01-05 01:57:30.497] ERROR: 删除AI助手失败:
Details: {
  "metadata": {
    "service": "ai-assistant-api",
    "error": "找不到指定的AI助手",
    "id": "6779e66cd22eadb0858e8c3b"
  }
}
